<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Usage - desgld</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Usage";
        var mkdocs_page_input_path = "use.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> desgld
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../desgld/">DeSGLD</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../net/">Network Structure</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../evaluation/">Evaluation</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Usage</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#demo-example">Demo Example</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#bayesian-logistic-regression-with-synthetic-data">Bayesian Logistic Regression with Synthetic Data</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#bayesian-linear-regression-with-synthetic-data">Bayesian Linear Regression with Synthetic Data</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../about/">Package</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">desgld</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Usage</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="usage-example">Usage Example</h1>
<div style="text-align: justify">
Bellow is an example of how to use the package `desgld`. Just like any other
package you usually install, you can install the `desgld` package using the
following command either in terminal or command line
</div>

<p><code>pip install git+ssh://git@github.com/mrislambd/desgld_package.git</code></p>
<h2 id="demo-example">Demo Example</h2>
<p>Here this is a complete example of how to use the package <code>desgld</code>.  </p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">desgld</span> <span class="kn">import</span> <span class="n">DeSGLD</span>
<span class="kn">from</span> <span class="nn">desgld</span> <span class="kn">import</span> <span class="n">NetworkArchitecture</span>
<span class="kn">from</span> <span class="nn">desgld</span> <span class="kn">import</span> <span class="n">ClassificationAccuracy</span>
<span class="kn">from</span> <span class="nn">desgld</span> <span class="kn">import</span> <span class="n">Wasserstein2Distance</span>
</code></pre></div>

<h2 id="bayesian-logistic-regression-with-synthetic-data">Bayesian Logistic Regression with Synthetic Data</h2>
<p><strong>Parameters</strong></p>
<div class="codehilite"><pre><span></span><code>size_w=6; N=100; sigma=1; eta=0.0005; T=20; dim=3; b=32; lam=10; total_data=1000; hv=np.linspace(0.001,0.5,5)
</code></pre></div>

<p><strong>Data</strong>  </p>
<div class="codehilite"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="n">total_data</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">x</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">[</span><span class="n">-20 + (20 + 20) * np.random.normal(), -10 + np.random.normal()</span><span class="o">]</span><span class="p">)</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">1 / (1 + np.exp(-item[0</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">item</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">x</span><span class="err">]</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="err">:</span>
<span class="w">    </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">y</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="err">:</span>
<span class="w">        </span><span class="n">y</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">else</span><span class="err">:</span>
<span class="w">        </span><span class="n">y</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="n">x_all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y_all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">x_all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span>
<span class="n">y_all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span>
<span class="n">x_all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">insert</span><span class="p">(</span><span class="n">x_all</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_all</span>

<span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    Data splitting</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">X_train1</span><span class="p">,</span><span class="w"> </span><span class="n">x_trainRemain</span><span class="p">,</span><span class="w"> </span><span class="n">y_train1</span><span class="p">,</span><span class="w"> </span><span class="n">y_trainRemain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train_test_split</span><span class="p">(</span>
<span class="w">    </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.83333</span><span class="p">,</span><span class="w"> </span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
<span class="n">X_train2</span><span class="p">,</span><span class="w"> </span><span class="n">x_trainRemain</span><span class="p">,</span><span class="w"> </span><span class="n">y_train2</span><span class="p">,</span><span class="w"> </span><span class="n">y_trainRemain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train_test_split</span><span class="p">(</span>
<span class="w">    </span><span class="n">x_trainRemain</span><span class="p">,</span><span class="w"> </span><span class="n">y_trainRemain</span><span class="p">,</span><span class="w"> </span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
<span class="n">X_train3</span><span class="p">,</span><span class="w"> </span><span class="n">x_trainRemain</span><span class="p">,</span><span class="w"> </span><span class="n">y_train3</span><span class="p">,</span><span class="w"> </span><span class="n">y_trainRemain</span><span class="w"> </span><span class="o">=</span><span class="n">train_test_split</span><span class="p">(</span>
<span class="w">    </span><span class="n">x_trainRemain</span><span class="p">,</span><span class="w"> </span><span class="n">y_trainRemain</span><span class="p">,</span><span class="w"> </span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span><span class="w"> </span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
<span class="n">X_train4</span><span class="p">,</span><span class="w"> </span><span class="n">x_trainRemain</span><span class="p">,</span><span class="w"> </span><span class="n">y_train4</span><span class="p">,</span><span class="w"> </span><span class="n">y_trainRemain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train_test_split</span><span class="p">(</span>
<span class="w">    </span><span class="n">x_trainRemain</span><span class="p">,</span><span class="w"> </span><span class="n">y_trainRemain</span><span class="p">,</span><span class="w"> </span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.66666666</span><span class="p">,</span><span class="w"> </span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
<span class="n">X_train5</span><span class="p">,</span><span class="w"> </span><span class="n">X_train6</span><span class="p">,</span><span class="w"> </span><span class="n">y_train5</span><span class="p">,</span><span class="w"> </span><span class="n">y_train6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train_test_split</span><span class="p">(</span>
<span class="w">    </span><span class="n">x_trainRemain</span><span class="p">,</span><span class="w"> </span><span class="n">y_trainRemain</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">X_train1, X_train2, X_train3, X_train4, X_train5, X_train6</span><span class="o">]</span>
<span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">y_train1, y_train2, y_train3, y_train4, y_train5, y_train6</span><span class="o">]</span>
</code></pre></div>

<p><strong>Vanila DeSGLD approximation</strong>  </p>
<div class="codehilite"><pre><span></span><code>net=NetworkArchitecture(size_w)
wf=net.fully_connected()
wc=net.circular_network()
wd=net.fully_disconnected()

nets=np.array([wf,wc,wd])
</code></pre></div>

<p>Run the Vanila DeSGLD algorithm for all three networks  </p>
<div class="codehilite"><pre><span></span><code><span class="n">three_net_combined</span><span class="o">=</span><span class="err">[]</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tqdm</span><span class="p">(</span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nets</span><span class="p">)))</span><span class="err">:</span>
<span class="w">    </span><span class="k">method</span><span class="o">=</span><span class="n">DeSGLD</span><span class="p">(</span><span class="n">size_w</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">eta</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">dim</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">lam</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">nets</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="n">hv</span><span class="p">,</span><span class="s1">&#39;logistic&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">vdesgld</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="k">method</span><span class="p">.</span><span class="n">vanila_desgld</span><span class="p">()</span>
<span class="w">    </span><span class="n">three_net_combined</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">vdesgld</span><span class="p">)</span>
</code></pre></div>

<p>Compute the accuracy  </p>
<div class="codehilite"><pre><span></span><code>desgld_acc=[]
desgld_std=[]
for desgld in tqdm(three_net_combined):
    desgld_accuracy=ClassificationAccuracy(x_all,y_all,desgld,T)
    d_acc,d_std=desgld_accuracy.compute_accuracy()
    desgld_acc.append(d_acc)
    desgld_std.append(d_std)
desgld_acc=np.array(desgld_acc)
desgld_std=np.array(desgld_std)
</code></pre></div>

<p>Next we plot the accuracy of the classification from the vanila DeSGLD</p>
<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="n">axs</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">desgld_acc</span><span class="p">),</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">26.4</span><span class="p">,</span><span class="mf">6.6</span><span class="p">))</span>
<span class="n">mpl</span><span class="p">.</span><span class="n">rcParams</span><span class="o">[</span><span class="n">&#39;font.size&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">24</span>
<span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="k">range</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="n">titles</span><span class="o">=[</span><span class="n">&quot;Fully Connected&quot;,&quot;Circular&quot;,&quot;Disconnected&quot;</span><span class="o">]</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">d_acc</span><span class="p">,</span><span class="w"> </span><span class="n">d_std</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">zip</span><span class="p">(</span><span class="n">desgld_acc</span><span class="p">,</span><span class="w"> </span><span class="n">desgld_std</span><span class="p">,</span><span class="w"> </span><span class="n">titles</span><span class="p">))</span><span class="err">:</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d_acc</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span><span class="k">index</span><span class="p">,</span><span class="w"> </span><span class="n">d_acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d_std</span><span class="p">,</span><span class="w"> </span><span class="n">d_acc</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">d_std</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="o">[</span><span class="n">&#39;Mean of accuracy&#39;, r&#39;Accuracy $\pm$ Std&#39;</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;Iterations $k$&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p>The plot<br />
<img alt="Figure 1" src="../plots/p1.png" />  </p>
<p><strong>EXTRA-DeSGLD Approximation</strong>  </p>
<div class="codehilite"><pre><span></span><code><span class="n">three_net_combined</span><span class="o">=</span><span class="err">[]</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tqdm</span><span class="p">(</span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nets</span><span class="p">)))</span><span class="err">:</span>
<span class="w">    </span><span class="k">method</span><span class="o">=</span><span class="n">DeSGLD</span><span class="p">(</span><span class="n">size_w</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">eta</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">dim</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">lam</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">nets</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="n">hv</span><span class="p">,</span><span class="s1">&#39;logistic&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">edesgld</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="k">method</span><span class="p">.</span><span class="n">extra_desgld</span><span class="p">()</span>
<span class="w">    </span><span class="n">three_net_combined</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">edesgld</span><span class="p">)</span>
</code></pre></div>

<p>Accuracy Calculations  </p>
<div class="codehilite"><pre><span></span><code><span class="n">extradesgld_acc</span><span class="o">=</span><span class="err">[]</span>
<span class="n">extradesgld_std</span><span class="o">=</span><span class="err">[]</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tqdm</span><span class="p">(</span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nets</span><span class="p">)))</span><span class="err">:</span>
<span class="w">    </span><span class="n">exacc</span><span class="o">=</span><span class="err">[]</span>
<span class="w">    </span><span class="n">exstd</span><span class="o">=</span><span class="err">[]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">hv</span><span class="p">))</span><span class="err">:</span>
<span class="w">        </span><span class="n">extradesgld_accuracy</span><span class="o">=</span><span class="n">ClassificationAccuracy</span><span class="p">(</span>
<span class="w">            </span><span class="n">x_all</span><span class="p">,</span><span class="n">y_all</span><span class="p">,</span><span class="n">three_net_combined</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="p">,</span><span class="n">T</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">acc</span><span class="p">,</span><span class="n">std</span><span class="o">=</span><span class="n">extradesgld_accuracy</span><span class="p">.</span><span class="n">compute_accuracy</span><span class="p">()</span>
<span class="w">        </span><span class="n">exacc</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span>
<span class="w">        </span><span class="n">exstd</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>
<span class="w">    </span><span class="n">extradesgld_acc</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">exacc</span><span class="p">)</span>
<span class="w">    </span><span class="n">extradesgld_std</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">exstd</span><span class="p">)</span>

<span class="n">extradesgld_acc</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="k">array</span><span class="p">(</span><span class="n">extradesgld_acc</span><span class="p">)</span>
<span class="n">extradesgld_std</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="k">array</span><span class="p">(</span><span class="n">extradesgld_std</span><span class="p">)</span>
</code></pre></div>

<p>Plot of the EXTRA DE-SGLD for each of the <code>h</code> values</p>
<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="n">axs</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">26.4</span><span class="p">,</span><span class="mf">8.6</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">sharey</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">mpl</span><span class="p">.</span><span class="n">rcParams</span><span class="o">[</span><span class="n">&#39;font.size&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">24</span>
<span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="k">range</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>


<span class="n">titles</span><span class="o">=[</span><span class="n">&#39;Fully Connected&#39;,&#39;Circular&#39;,&#39;Disconnected&#39;</span><span class="o">]</span>

<span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">h_value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">hv</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="k">index</span><span class="p">,</span><span class="n">extradesgld_acc</span><span class="o">[</span><span class="n">j</span><span class="o">][</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;h = {h_value:.3f}&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;Iterations $k$&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p><img alt="Figure 2" src="../plots/p2.png" />  </p>
<p>Find the Maximum Accuracy for the optimal <code>h</code> values</p>
<div class="codehilite"><pre><span></span><code><span class="n">max_acc_arrays</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>
<span class="n">max_acc_indices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>

<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nets</span><span class="p">))</span><span class="err">:</span>
<span class="w">    </span><span class="n">max_acc_array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extradesgld_acc</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">np.argmax(np.max(extradesgld_acc[i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="err">]</span>
<span class="w">    </span><span class="n">max_acc_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">max</span><span class="p">(</span><span class="n">extradesgld_acc</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="w">    </span><span class="n">max_acc_arrays</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_acc_array</span><span class="p">)</span>
<span class="w">    </span><span class="n">max_acc_indices</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_acc_index</span><span class="p">)</span>

<span class="n">max_acc_arrays</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">array</span><span class="p">(</span><span class="n">max_acc_arrays</span><span class="p">)</span>
<span class="n">max_acc_indices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">array</span><span class="p">(</span><span class="n">max_acc_indices</span><span class="p">)</span>
<span class="n">max_hv_values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hv</span><span class="o">[</span><span class="n">max_acc_indices</span><span class="o">]</span>

<span class="n">max_acc_stds</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="nf">len</span><span class="p">(</span><span class="n">nets</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nets</span><span class="p">))</span><span class="err">:</span>
<span class="w">    </span><span class="n">max_acc_stds</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extradesgld_std</span><span class="o">[</span><span class="n">i, max_acc_indices[i</span><span class="o">]</span><span class="err">]</span>
</code></pre></div>

<p>Next plot the maximum accuracy for the optimal <code>h</code>  </p>
<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="n">axs</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">26.4</span><span class="p">,</span><span class="mf">6.6</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">sharey</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>

<span class="n">mpl</span><span class="p">.</span><span class="n">rcParams</span><span class="o">[</span><span class="n">&#39;font.size&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">24</span>
<span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="k">range</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>


<span class="n">titles</span><span class="o">=[</span><span class="n">&#39;Fully Connected&#39;,&#39;Circular&#39;,&#39;Disconnected&#39;</span><span class="o">]</span>

<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">title</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">max_acc_arrays</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;h = {max_hv_values[i]:.3f}&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span>
<span class="w">        </span><span class="k">index</span><span class="p">,</span><span class="n">max_acc_arrays</span><span class="o">[</span><span class="n">i</span><span class="o">]+</span><span class="n">max_acc_stds</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="n">max_acc_arrays</span><span class="o">[</span><span class="n">i</span><span class="o">]-</span><span class="n">max_acc_stds</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;Iterations $k$&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p><img alt="Figure 3" src="../plots/p3.png" />  </p>
<p>Now we can compare the approximations from both of the 
Vanila and Extra DeSGLD algorithms</p>
<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="n">axs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">26.4</span><span class="p">,</span><span class="w"> </span><span class="mf">6.6</span><span class="p">),</span><span class="w"> </span><span class="n">sharex</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">sharey</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>

<span class="n">mpl</span><span class="p">.</span><span class="n">rcParams</span><span class="o">[</span><span class="n">&#39;font.size&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">24</span>
<span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="k">range</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>

<span class="n">titles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">&#39;Fully Connected&#39;, &#39;Circular&#39;, &#39;Disconnected&#39;</span><span class="o">]</span>

<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">desgld_acc</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;Vanila DESGLD&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span>
<span class="w">        </span><span class="k">index</span><span class="p">,</span><span class="w"> </span><span class="n">desgld_acc</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">desgld_std</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">desgld_acc</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">desgld_std</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span>
<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">max_acc_arrays</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;r-&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;EXTRA DESGLD, h = {max_hv_values[i]:.3f}&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span>
<span class="w">        </span><span class="k">index</span><span class="p">,</span><span class="w"> </span><span class="n">max_acc_arrays</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">max_acc_stds</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">max_acc_arrays</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">max_acc_stds</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;Iterations $k$&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p><img alt="Figure 4" src="../plots/p4.png" />  </p>
<h2 id="bayesian-linear-regression-with-synthetic-data">Bayesian Linear Regression with Synthetic Data</h2>
<p><strong>Parameters</strong></p>
<div class="codehilite"><pre><span></span><code>size_w=20; N=20; dim=2; sigma=np.eye(dim); sigma_sample=1; 
eta=0.009 ; T=50; lam=10; b=50;  hv=np.linspace(0.001,0.5,5); 
</code></pre></div>

<p><strong>Data Generation</strong>  </p>
<div class="codehilite"><pre><span></span><code>x=[]

for i in range(1000):
    x.append([np.random.random()*1])

y=[item[0]*3-0.5+np.random.random() for item in x]

x_all=np.array(x)
y_all=np.array(y)
x_all=np.insert(x_all, 0, 1, axis=1)
cov_pri=lam*sigma

avg_post=np.dot(
    np.linalg.inv(np.linalg.inv(cov_pri)+np.dot(np.transpose(x_all),x_all)/(sigma_sample**2)),
    (np.dot(np.transpose(x_all),y_all)/(sigma_sample**2))
)
cov_post=np.linalg.inv(np.linalg.inv(cov_pri)+np.dot(np.transpose(x_all),x_all)/(sigma_sample**2))

x=np.split(x_all,100)
y=np.split(y_all,100)
</code></pre></div>

<p><strong>Vanila DeSGLD Approximation</strong>  </p>
<div class="codehilite"><pre><span></span><code>net=NetworkArchitecture(size_w)
wf=net.fully_connected()
wc=net.circular_network()
wd=net.fully_disconnected()

nets=np.array([wf,wc,wd])
</code></pre></div>

<p>Run the Vanila DeSGLD algorithm for all three networks  </p>
<div class="codehilite"><pre><span></span><code><span class="n">three_net_combined_agents</span><span class="o">=</span><span class="err">[]</span>
<span class="n">three_net_combined_magents</span><span class="o">=</span><span class="err">[]</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tqdm</span><span class="p">(</span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nets</span><span class="p">)))</span><span class="err">:</span>
<span class="w">    </span><span class="k">method</span><span class="o">=</span><span class="n">DeSGLD</span><span class="p">(</span><span class="n">size_w</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">eta</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">dim</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">lam</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">nets</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="n">hv</span><span class="p">,</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">desgld_agents</span><span class="p">,</span><span class="n">desgld_magents</span><span class="o">=</span><span class="k">method</span><span class="p">.</span><span class="n">vanila_desgld</span><span class="p">()</span>
<span class="w">    </span><span class="n">three_net_combined_agents</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">desgld_agents</span><span class="p">)</span>
<span class="w">    </span><span class="n">three_net_combined_magents</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">desgld_magents</span><span class="p">)</span>
</code></pre></div>

<p>Compute the <code>w_2</code> distance  </p>
<div class="codehilite"><pre><span></span><code>desgld_three_net_combined_dist=[]
for dis_agent,dis_magent in tqdm(zip(three_net_combined_agents,three_net_combined_magents)):
    distance=Wasserstein2Distance(size_w,T,avg_post,cov_post,dis_agent,dis_magent)
    dis=distance.W2_dist()
    desgld_three_net_combined_dist.append(dis)
</code></pre></div>

<p>Next plot the distances  </p>
<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="n">axs</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">26.4</span><span class="p">,</span><span class="mf">6.6</span><span class="p">))</span>
<span class="n">mpl</span><span class="p">.</span><span class="n">rcParams</span><span class="o">[</span><span class="n">&#39;font.size&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">24</span>
<span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="k">range</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="n">titles</span><span class="o">=[</span><span class="n">&quot;Fully Connected: DESGLD&quot;,&quot;Circular: DESGLD&quot;,&quot;Disconnected: DESGLD&quot;</span><span class="o">]</span>

<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">desgld_three_net_combined_dist</span><span class="p">))</span><span class="err">:</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="k">index</span><span class="p">,</span><span class="n">desgld_three_net_combined_dist</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">r</span><span class="s1">&#39;Agent 1 $x_1^{(k)}$&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">desgld_three_net_combined_dist</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">1</span><span class="o">]</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">r</span><span class="s1">&#39;Agent 2 $x_2^{(k)}$&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">desgld_three_net_combined_dist</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">2</span><span class="o">]</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">r</span><span class="s1">&#39;Agent 3 $x_3^{(k)}$&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">desgld_three_net_combined_dist</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">3</span><span class="o">]</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">r</span><span class="s1">&#39;Agent 4 $x_4^{(k)}$&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">desgld_three_net_combined_dist</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">-1</span><span class="o">]</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">r</span><span class="s1">&#39;Mean of Agents $\bar{x}^{(k)}$&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;Iterations $k$&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;$\mathcal{W}_2$ Distance &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span><span class="w">    </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p>Here is the plot<br />
<img alt="Figure 5" src="../plots/p5.png" />  </p>
<p><strong>EXTRA DeSGLD Approximation</strong>  </p>
<p>Run the EXTRA DeSGLD algorithm for all three networks</p>
<div class="codehilite"><pre><span></span><code><span class="n">three_net_combined_agents</span><span class="o">=</span><span class="err">[]</span>
<span class="n">three_net_combined_magents</span><span class="o">=</span><span class="err">[]</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tqdm</span><span class="p">(</span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nets</span><span class="p">)))</span><span class="err">:</span>
<span class="w">    </span><span class="k">method</span><span class="o">=</span><span class="n">DeSGLD</span><span class="p">(</span><span class="n">size_w</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">eta</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">dim</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">lam</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">nets</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="n">hv</span><span class="p">,</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">edesgld_agents</span><span class="p">,</span><span class="n">edesgld_magents</span><span class="o">=</span><span class="k">method</span><span class="p">.</span><span class="n">extra_desgld</span><span class="p">()</span>
<span class="w">    </span><span class="n">three_net_combined_agents</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">edesgld_agents</span><span class="p">)</span>
<span class="w">    </span><span class="n">three_net_combined_magents</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">edesgld_magents</span><span class="p">)</span>
</code></pre></div>

<p>Compute the <code>w_2</code>  Distances  </p>
<div class="codehilite"><pre><span></span><code><span class="n">extradesgld_three_net_combined_dist</span><span class="o">=</span><span class="err">[]</span>

<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tqdm</span><span class="p">(</span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nets</span><span class="p">)))</span><span class="err">:</span>
<span class="w">    </span><span class="n">ex</span><span class="o">=</span><span class="err">[]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">hv</span><span class="p">))</span><span class="err">:</span>
<span class="w">        </span><span class="n">extradistance</span><span class="o">=</span><span class="n">Wasserstein2Distance</span><span class="p">(</span>
<span class="w">            </span><span class="n">size_w</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">avg_post</span><span class="p">,</span><span class="n">cov_post</span><span class="p">,</span>
<span class="w">            </span><span class="n">three_net_combined_agents</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="p">,</span>
<span class="w">            </span><span class="n">three_net_combined_magents</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">ex</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">extradistance</span><span class="p">.</span><span class="n">W2_dist</span><span class="p">())</span>
<span class="w">    </span><span class="n">extradesgld_three_net_combined_dist</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>

<span class="n">extradesgld_three_net_combined_dist</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="k">array</span><span class="p">(</span><span class="n">extradesgld_three_net_combined_dist</span><span class="p">)</span>
</code></pre></div>

<p>Work with the <code>w_2</code> distances of mean agents  </p>
<div class="codehilite"><pre><span></span><code>mean_dist = np.empty((len(nets), len(hv), T+1))
for i in tqdm(range(len(nets))):
    for j in range(len(hv)):
        mean_dist[i, j, :] = extradesgld_three_net_combined_dist[i, j, -1, :]
</code></pre></div>

<p>Plot the <code>w_2</code> distance of mean agents for each <code>h</code> values</p>
<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="n">axs</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">26.4</span><span class="p">,</span><span class="mf">8.6</span><span class="p">),</span><span class="w"> </span><span class="n">sharex</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">sharey</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">mpl</span><span class="p">.</span><span class="n">rcParams</span><span class="o">[</span><span class="n">&#39;font.size&#39;</span><span class="o">]=</span><span class="mi">24</span>

<span class="n">titles</span><span class="o">=[</span><span class="n">&#39;Fully Connected&#39;,&#39;Circular&#39;, &#39;Disconnected&#39;</span><span class="o">]</span>

<span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">h_value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">hv</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mean_dist</span><span class="o">[</span><span class="n">j</span><span class="o">][</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;h={h_value:.3f}&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;Iterations $k$&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;$\mathcal{W}_2$ Dist. of mean agents&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p><img alt="Figure 6" src="../plots/p6.png" />  </p>
<p>Find the minimum distance for optimal <code>h</code> values  </p>
<div class="codehilite"><pre><span></span><code><span class="n">min_dist_arrays</span><span class="o">=</span><span class="err">[]</span>
<span class="n">min_dist_indices</span><span class="o">=</span><span class="err">[]</span>

<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nets</span><span class="p">))</span><span class="err">:</span>
<span class="w">    </span><span class="n">min_dist_array</span><span class="o">=</span><span class="n">mean_dist</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">np.argmin(np.min(mean_dist[i</span><span class="o">]</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="err">]</span>
<span class="w">    </span><span class="n">min_dist_index</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">min</span><span class="p">(</span><span class="n">mean_dist</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="w">    </span><span class="n">min_dist_arrays</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">min_dist_array</span><span class="p">)</span>
<span class="w">    </span><span class="n">min_dist_indices</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">min_dist_index</span><span class="p">)</span>

<span class="n">min_dist_arrays</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="k">array</span><span class="p">(</span><span class="n">min_dist_arrays</span><span class="p">)</span>
<span class="n">min_dist_indices</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="k">array</span><span class="p">(</span><span class="n">min_dist_indices</span><span class="p">)</span>
<span class="n">min_hv_values</span><span class="o">=</span><span class="n">hv</span><span class="o">[</span><span class="n">min_dist_indices</span><span class="o">]</span>
<span class="n">min_hv_values</span>
</code></pre></div>

<p>Plot the <em>Optimal EXTRA DeSGLD Mean Distance</em> for the optimal <code>h</code> value  </p>
<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span><span class="n">axs</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">26.4</span><span class="p">,</span><span class="mf">8.6</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">sharey</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">mpl</span><span class="p">.</span><span class="n">rcParams</span><span class="o">[</span><span class="n">&#39;font.size&#39;</span><span class="o">]=</span><span class="mi">24</span>

<span class="n">titles</span><span class="o">=[</span><span class="n">&#39;Fully Connected&#39;,&#39;Circular&#39;, &#39;Disconnected&#39;</span><span class="o">]</span>

<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">title</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">min_dist_arrays</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;h={min_hv_values[i]:.3f}&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;Iterations $k$&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;$\mathcal{W}_2$ Dist. of mean agents&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p><img alt="Figure 7" src="../plots/p7.png" /> </p>
<p>Finally, we can compare the performances from both of the
algorithms  </p>
<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span><span class="n">axs</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">26.4</span><span class="p">,</span><span class="mf">8.6</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">sharey</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">mpl</span><span class="p">.</span><span class="n">rcParams</span><span class="o">[</span><span class="n">&#39;font.size&#39;</span><span class="o">]=</span><span class="mi">24</span>

<span class="n">titles</span><span class="o">=[</span><span class="n">&#39;Fully Connected&#39;,&#39;Circular&#39;, &#39;Disconnected&#39;</span><span class="o">]</span>

<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">title</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">min_dist_arrays</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;EXTRA DESGLD for h={min_hv_values[i]:.3f}&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">desgld_three_net_combined_dist</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">-1</span><span class="o">]</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Vanila DESGLD&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;Iterations $k$&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;$\mathcal{W}_2$ Dist. of mean agents&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p>And, here is the plot  </p>
<p><img alt="Figure 8" src="../plots/p8.png" /></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../evaluation/" class="btn btn-neutral float-left" title="Evaluation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../about/" class="btn btn-neutral float-right" title="Package">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../evaluation/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../about/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
